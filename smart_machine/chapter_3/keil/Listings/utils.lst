C51 COMPILER V9.60.7.0   UTILS                                                             04/22/2024 11:15:07 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE UTILS
OBJECT MODULE PLACED IN .\Objects\utils.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\utils.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\
                    -utils.lst) TABS(2) OBJECT(.\Objects\utils.obj)

line level    source

   1          typedef unsigned char uchar;
   2          typedef unsigned int uint;
   3          
   4          extern xdata unsigned char CWADD1 ;   // 写指令代码地址(E1)
   5          extern xdata unsigned char DWADD1 ;   // 写显示数据地址(E1)
   6          extern xdata unsigned char CRADD1 ;   // 读状态字地址(E1)
   7          extern xdata unsigned char DRADD1 ;   // 读显示数据地址(E1)
   8          
   9          extern xdata unsigned char CWADD2 ;   // 写指令代码地址(E2)
  10          extern xdata unsigned char DWADD2 ;   // 写显示数进地址(E2)
  11          extern xdata unsigned char CRADD2 ;   // 读状态字地址(E2)
  12          extern xdata unsigned char DRADD2 ;   // 读显示数据地址(E2)
  13          
  14          
  15          extern unsigned char Column;
  16          extern unsigned char Page_ ;  // 页地址寄存器 D1,DO:页地址
  17          extern unsigned char Code_ ;  // 字符代码寄存器
  18          
  19          extern unsigned char Command; // 指令寄存器
  20          extern unsigned char LCDData; // 数据寄存器
  21          
  22          
  23          
  24          // 1.写指令代码子程序(E1)
  25          void WriteCommandE1()
  26          {
  27   1        while(CRADD1 & 0x80);
  28   1        CWADD1 = Command;
  29   1      }
  30          
  31          // 2.写显示数据子程序(E1)
  32          void WriteDataE1()
  33          {
  34   1        while(CRADD1 & 0x80);
  35   1        DWADD1 = LCDData;
  36   1      }
  37          
  38          // 3.读显示数据子程序(E1)
  39          void ReadDataE1()
  40          {
  41   1        while(CRADD1 & 0x80);
  42   1        LCDData = DRADD1;
  43   1      }
  44          
  45          // 4.写指令代码子程序(E2)
  46          void WriteCommandE2()
  47          {
  48   1        while(CRADD2 & 0x80);
  49   1        CWADD2 = Command;
  50   1      }
  51          
  52          // 5.写显示数据子程序(E2)
  53          void WriteDataE2()
  54          {
C51 COMPILER V9.60.7.0   UTILS                                                             04/22/2024 11:15:07 PAGE 2   

  55   1        while(CRADD2 & 0x80);
  56   1        DWADD2 = LCDData;
  57   1      }
  58          
  59          // 6.读显示数据子程序(E2)
  60          void ReadDataE2()
  61          {
  62   1        while(CRADD2 & 0x80);
  63   1        LCDData = DRADD2;
  64   1      }
  65          
  66          // 初始化程序
  67          void Init()
  68          {
  69   1        Command = 0xe2;
  70   1        WriteCommandE1();
  71   1        WriteCommandE2();
  72   1      
  73   1        Command = 0xa4;
  74   1        WriteCommandE1();
  75   1        WriteCommandE2();
  76   1      
  77   1        Command = 0xa9;
  78   1        WriteCommandE1();
  79   1        WriteCommandE2();
  80   1      
  81   1        Command = 0xa0;
  82   1        WriteCommandE1();
  83   1        WriteCommandE2();
  84   1      
  85   1        Command = 0xc0;
  86   1        WriteCommandE1();
  87   1        WriteCommandE2();
  88   1      
  89   1        Command = 0xaf;
  90   1        WriteCommandE1();
  91   1        WriteCommandE2();
  92   1      }
  93          
  94          // 清屏
  95          void Clear()
  96          {
  97   1        unsigned char i,j;
  98   1      
  99   1        i = 0;
 100   1        do {
 101   2      
 102   2          Command = (i + 0xb8); // 页地址设置
 103   2          WriteCommandE1();
 104   2          WriteCommandE2();
 105   2      
 106   2          Command = 0x00;      // 列地址设置为"0"
 107   2          WriteCommandE1();
 108   2          WriteCommandE2();
 109   2      
 110   2          j = 0x50;            // 一页清 80个字节
 111   2          do {
 112   3            LCDData = 0x00;    // 显示数据为"0"
 113   3            WriteDataE1();
 114   3            WriteDataE2();
 115   3          }while(--j !=0);     // 页内字节清零循环
 116   2      
C51 COMPILER V9.60.7.0   UTILS                                                             04/22/2024 11:15:07 PAGE 3   

 117   2        }while(++i !=4);       // 页地址暂存器加一
 118   1                               // 显示区清零循环
 119   1      }
 120          void Delay5ms()   //@12.000MHz
 121          {
 122   1        unsigned char i, j;
 123   1      
 124   1        i = 10;
 125   1        j = 183;
 126   1        do
 127   1        {
 128   2          while (--j);
 129   2        } while (--i);
 130   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    183    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
